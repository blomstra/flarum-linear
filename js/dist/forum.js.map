{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@blomstra/linear/webpack/bootstrap","webpack://@blomstra/linear/webpack/runtime/compat get default export","webpack://@blomstra/linear/webpack/runtime/define property getters","webpack://@blomstra/linear/webpack/runtime/hasOwnProperty shorthand","webpack://@blomstra/linear/webpack/runtime/make namespace object","webpack://@blomstra/linear/external root \"flarum.core.compat['forum/app']\"","webpack://@blomstra/linear/external root \"flarum.core.compat['common/extend']\"","webpack://@blomstra/linear/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@blomstra/linear/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@blomstra/linear/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@blomstra/linear/external root \"flarum.core.compat['common/components/Button']\"","webpack://@blomstra/linear/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@blomstra/linear/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@blomstra/linear/./src/forum/components/SendToLinearModal.tsx","webpack://@blomstra/linear/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@blomstra/linear/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@blomstra/linear/./src/forum/index.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","import Modal from 'flarum/common/components/Modal';\nimport app from 'flarum/forum/app';\nimport Button from 'flarum/common/components/Button';\n\nexport default class SendToLinearModal extends Modal {\n  static isDismissibleViaCloseButton = true;\n  static isDismissibleViaEscKey = true;\n  static isDismissibleViaBackdropClick = true;\n\n  teams = [];\n  priorities = [];\n  defaultTeam = '';\n  selectedTeam = '';\n  selectedPriority = 0;\n  tags = [];\n\n  loadData(): void {\n    m.request({\n      method: 'GET',\n      url: '/api/linear/teams',\n    }).then((response) => {\n      this.teams = response.data.attributes;\n    });\n\n    m.request({\n      method: 'GET',\n      url: '/api/linear/priorities',\n    }).then((response) => {\n      this.priorities = response.data.attributes;\n    });\n  }\n\n  className() {\n    // Custom CSS classes to apply to the modal\n    return 'custom-modal-class';\n  }\n\n  title() {\n    // Title of the modal.\n    return app.translator.trans('blomstra-linear.forum.modals.title');\n  }\n\n  content() {\n    if (this.teams.length > 0 && this.priorities.length > 0 && this.selectedTeam !== '') {\n      return (\n        <>\n          <div class=\"Modal-body\">\n            <div class=\"Form\">\n              <div class=\"Form-group\">\n                <label>{app.translator.trans('blomstra-linear.forum.modals.fields.team')}</label>\n                <span class=\"Select\">\n                  <select\n                    value={this.selectedTeam}\n                    class=\"Select-input FormControl\"\n                    onchange={(e) => {\n                      this.selectedTeam = e.target.value;\n                    }}\n                  >\n                    {this.teams.map((team) => {\n                      return <option value={team.id}>{team.name}</option>;\n                    })}\n                  </select>\n                </span>\n              </div>\n              <div class=\"Form-group\">\n                <label>{app.translator.trans('blomstra-linear.forum.modals.fields.priority')}</label>\n                <span class=\"Select\">\n                  <select\n                    class=\"Select-input FormControl\"\n                    value={this.selectedPriority}\n                    onchange={(e) => {\n                      this.selectedPriority = e.target.value;\n                    }}\n                  >\n                    {this.priorities.map((priority) => {\n                      return <option value={priority.priority}>{priority.label}</option>;\n                    })}\n                  </select>\n                </span>\n              </div>\n              <div class=\"Form-group\">\n                <Button className=\"Button Button--primary\" type=\"submit\">\n                  <i id=\"linear-submission-loading\" class=\"fa fa-spinner fa-spin visually-hidden\" aria-hidden=\"true\"></i>\n                  {app.translator.trans('blomstra-linear.forum.controls.send_to_linear_button')}\n                </Button>\n              </div>\n            </div>\n          </div>\n        </>\n      );\n    } else {\n      return (\n        <>\n          <div class=\"Modal-body\">\n            <p class=\"center\">\n              <i class=\"fas fa-spinner fa-spin\" aria-hidden=\"true\"></i>\n              {app.translator.trans('blomstra-linear.forum.modals.loading')}\n            </p>\n          </div>\n        </>\n      );\n    }\n  }\n\n  onsubmit(e) {\n    e.preventDefault();\n    // If your modal contains a form, you can add form processing logic here.\n    // Show the icon in the submit button\n    document.getElementById('linear-submission-loading').classList.remove('visually-hidden');\n\n    m.request({\n      method: 'POST',\n      url: '/api/linear/issues',\n      headers: {\n        'X-CSRF-Token': app.session.csrfToken,\n      },\n      body: {\n        team: this.selectedTeam,\n        priority: this.selectedPriority,\n        tags: this.tags,\n        discussion: this.attrs.discussion.id(),\n      },\n    }).then((response) => {\n      app.forum.pushAttributes({\n        blomstraLinearLastPriority: this.selectedPriority,\n        blomstraLinearLastTeamId: this.selectedTeam,\n      });\n\n      if (response.data.id !== undefined || response.data.id !== null) {\n        this.attrs.linear = response.data.id;\n        app.current.data.discussion.data.attributes.linearIssueId = response.data.id;\n        document.getElementById('linear-submission-loading').classList.add('visually-hidden');\n        m.redraw();\n        this.hide();\n      } else {\n        alert('Something went wrong, please try again.');\n      }\n    });\n  }\n\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loadData();\n\n    this.defaultTeam = app.forum.attribute('blomstraLinearDefaultTeamId');\n    const lastSelectedTeam = app.forum.attribute('blomstraLinearLastTeamId');\n\n    this.selectedTeam = this.defaultTeam ?? lastSelectedTeam;\n\n    this.selectedPriority = app.forum.attribute('blomstraLinearLastPriority') ?? 0;\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\nimport Discussion from 'flarum/common/models/Discussion';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport Button from 'flarum/common/components/Button';\nimport SendToLinearModal from './components/SendToLinearModal';\nimport Badge from 'flarum/common/components/Badge';\n\napp.initializers.add('blomstra/linear', () => {\n  extend(DiscussionPage.prototype, 'sidebarItems', function (items) {\n    const discussion: Discussion = this.discussion;\n    let linear = null;\n    linear = discussion.attribute('linearIssueId');\n    let lx = linear !== null && linear !== undefined ? linear.split(':::') : 'a:::b';\n    let lOrg = lx[0];\n    let lId = lx[1];\n\n    const canAddToLinear = discussion.attribute('canAddToLinear');\n    if (!canAddToLinear) {\n      return;\n    }\n\n    items.add(\n      'blomstra-linear',\n      linear === null ? (\n        <Button icon=\"far fa-paper-plane\" class=\"Button\" onclick={() => app.modal.show(SendToLinearModal, { discussion })}>\n          {app.translator.trans('blomstra-linear.forum.controls.send_to_linear_button')}\n        </Button>\n      ) : (\n        <LinkButton icon=\"far fa-paper-plane\" class=\"Button\" href={'https://linear.app/' + lOrg + '/issue/' + lId} external={true} target=\"_blank\">\n          {app.translator.trans('blomstra-linear.forum.controls.open_in_linear_button')}\n        </LinkButton>\n      ),\n      100\n    );\n  });\n\n  extend(Discussion.prototype, 'badges', function (badges) {\n    let linear = null;\n    linear = this.attribute('linearIssueId');\n    let lx = linear !== undefined && linear !== null ? linear.split(':::') : 'a:::b';\n    let lOrg = lx[0];\n    let lId = lx[1];\n    const canAddToLinear = this.attribute('canAddToLinear');\n\n    if (canAddToLinear && linear !== null) {\n      badges.add(\n        'linear',\n        <Badge type=\"linear\" icon=\"far fa-paper-plane\" label={app.translator.trans('blomstra-linear.forum.badges.linear.tooltip')} />,\n        10\n      );\n    }\n  });\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","SendToLinearModal","_Modal","subClass","superClass","_this","_len","arguments","length","args","Array","_key","apply","concat","teams","priorities","defaultTeam","selectedTeam","selectedPriority","tags","create","constructor","_proto","loadData","_this2","m","request","method","url","then","response","data","attributes","className","title","app","trans","content","_this3","this","'['","class","onchange","e","target","map","team","id","name","priority","label","Button","type","onsubmit","_this4","preventDefault","document","getElementById","classList","remove","headers","csrfToken","body","discussion","attrs","pushAttributes","blomstraLinearLastPriority","blomstraLinearLastTeamId","undefined","linear","linearIssueId","add","redraw","hide","alert","oninit","vnode","_this$defaultTeam","_app$forum$attribute","attribute","lastSelectedTeam","Modal","isDismissibleViaCloseButton","isDismissibleViaEscKey","isDismissibleViaBackdropClick","extend","DiscussionPage","items","lx","split","lOrg","lId","icon","onclick","show","LinkButton","href","external","Discussion","badges","Badge"],"sourceRoot":""}